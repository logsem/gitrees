\def\stackreltwo#1#2{\mathrel{\mathop{#2}\limits^{#1}}}

\newcommand{\gitree}{GITree\xspace}
\newcommand{\gitrees}{GITrees\xspace}
\newcommand{\IT}{\mathbf{IT}}
\newcommand{\ITv}{\mathbf{IT}^v}
\newcommand{\Ins}{\mathit{Ins}}
\newcommand{\Outs}{\mathit{Outs}}
\newcommand{\Type}{\mathit{Type}}
\newcommand{\Hom}{\mathit{Hom}}

\newcommand{\foldIT}{\mathit{fold}}
\newcommand{\unfoldIT}{\mathit{unfold}}

\newcommand{\Next}{\latertinj}
% IT constructors
\newcommand{\Error}{\mathtt{Error}}
\newcommand{\RunTime}{\mathit{RunTime}}
\newcommand{\Rret}{\mathsf{Ret}}
\newcommand{\Err}{\mathsf{Err}}
\newcommand{\Fun}{\mathsf{Fun}}
\newcommand{\Tau}{\mathsf{Tau}}
\newcommand{\Tick}{\mathsf{Tick}}
\newcommand{\Vis}{\mathsf{Vis}}
\newcommand{\idfun}{\mathsf{id}}

\newcommand{\idx}{{\mathtt i}}

\newcommand{\getfun}{\mathsf{get\_fun}}
\newcommand{\getval}{\mathsf{get\_val}}
\newcommand{\getnat}{\mathsf{get\_nat}}
\newcommand{\getret}{\mathsf{get\_ret}}

\newcommand{\inl}{\textlog{inl}}
\newcommand{\inr}{\textlog{inr}}
\newcommand{\inj}{\textlog{inj}}

% programming
\newcommand{\APPl}{\mathsf{App}_l}
\newcommand{\APPs}[2]{#1 \mathrel{\bullet} #2}
\newcommand{\APPsl}[2]{#1 \mathrel{(\latert\bullet)} #2}
\newcommand{\IF}{\mathsf{If}}
\newcommand{\NATOP}{\mathsf{NatOp}}
\newcommand{\SEQ}{\mathrel{;}}
\def\LET#1=#2IN{\mathsf{Let} \spac #1 \mathrel{=} #2 \spac \mathsf{in} \spac}
\newcommand{\WHILE}[2]{\mathsf{While} \spac #1 \spac \mathsf{do} \spac #2}

% effects
\newcommand{\INPUT}{\mathsf{Input}}
\newcommand{\OUTPUT}{\mathsf{Output}}

\newcommand{\ALLOC}{\mathsf{Alloc}}
\newcommand{\DEALLOC}{\mathsf{Dealloc}}
\newcommand{\READ}{\mathsf{Read}}
\newcommand{\WRITE}{\mathsf{Write}}
\newcommand{\callccEff}{\mathsf{CALLCC}}
\newcommand{\throwEff}{\mathsf{THROW}}

\newcommand{\callccGT}{\mathrm{Callcc}}
\newcommand{\throwGT}{\mathrm{Throw}}

% reification
\newcommand{\stateO}{\mathit{State}}
\newcommand{\optionO}{\mathit{option}}
\newcommand{\reify}{\mathsf{reify}}
\renewcommand{\Some}{\mathsf{Some}}

\newcommand{\istep}{\rightsquigarrow}

% object languages
\newcommand{\iocclang}{\lambda_{\mathsf{rec},\mathsf{io,callcc}}}
\newcommand{\iolang}{\lambda_{\mathsf{rec},\mathsf{io}}}
\newcommand{\Input}{\langkw{input}}
\newcommand{\Output}{\langkw{output} \spac}
\newcommand\bigcdot{\mathrel{\raisebox{1pt}{$\scriptscriptstyle\bullet$}}}
\newcommand\holed[1]{[\,#1\,]}
\newcommand\ctxhole{\holed\bigcdot}
\newcommand{\Tnat}{\mathsf{Nat}}
\newcommand{\scope}{\mathsf{scope}}
\newcommand{\fv}{\mathsf{fv}}

% affine lang

\newcommand{\afflang}{\lambda_{\mathsf{\multimap},\mathsf{ref}}}
\newcommand{\lolli}{{\color{orange}\multimap}}
\newcommand{\atensor}{{\color{orange}\otimes}}
\newcommand{\avar}{{\color{orange}a}}
\newcommand{\typeAff}{{\color{orange}\tau}}
\newcommand{\langkwa}[1]{\textlang{\color{orange} #1}}  % Lars
\newcommand{\tBool}{\langkwa{Bool}}
\newcommand{\tNat}{\langkwa{Nat}}
\newcommand{\tUnit}{\langkwa{Unit}}
\newcommand{\tRef}[1]{{\langkwa{ref}\ #1}}
\newcommand{\unittt}{()}
\def\LamA #1.{{\color{orange}\lambda} #1.\spac}%
\newcommand{\aPair}[2]{{\color{orange}(}#1{\color{orange},}#2{\color{orange})}}
\def\LetA#1=#2in{\langkwa{let} \spac #1 \mathrel{{\color{orange}=}} #2 \spac \langkwa{in} \spac}
\newcommand{\aAlloc}{\langkwa{alloc}}
\newcommand{\aDealloc}{\langkwa{dealloc}}
\newcommand{\aReplace}{\langkwa{replace}}
\newcommand{\aCtx}{{\color{orange}\Omega}}
\newcommand{\provesAff}{\mathrel{{\color{orange}\proves}}}
\newcommand{\modelsAff}{\mathrel{{\color{orange}\models}}}
\newcommand{\aEmbed}[1]{{\color{orange}\llparenthesis} #1 {\color{orange}\rrparenthesis}}
\newcommand{\tyconv}[2]{#1 \sim {\color{orange}#2}}



\newcommand{\Force}{\mathsf{Force}}
\newcommand{\Thunk}{\mathsf{Thunk}}
\newcommand{\protec}{\mathsf{protected}}

% program logic
\newcommand{\hasstate}{\mathsf{has\_state}}
\newcommand{\heapctx}{\mathsf{heap\_ctx}}

\newcommand{\AffSem}[1]{\mathit{Aff}\Sem{#1}}
\newcommand{\IOSem}[1]{\mathit{IO}\Sem{#1}}
\newcommand{\fromAff}{C}
\newcommand{\toAff}{{\color{orange}C}}

% logical relation
\newcommand{\refines}{\precsim}
\newcommand{\EE}[1]{\mathcal{E}\Sem{#1}}
\newcommand{\AEE}[1]{{\color{orange}\mathcal{E}}\Sem{{\color{orange}#1}}}
\newcommand{\EK}[3]{\mathcal{E}^{#2}_{#1}(#3)}
\newcommand{\VV}[1]{\mathcal{V}\Sem{#1}}
\newcommand{\AVV}[1]{{\color{orange}\mathcal{V}}\Sem{{\color{orange}#1}}}
\newcommand{\VVCtx}[1]{\mathcal{V}^{\ast}\Sem{#1}}
\newcommand{\AVVCtx}[1]{{\color{orange}\mathcal{V}^{\ast}}\Sem{#1}}

% subeffects/subreifiers
\newcommand{\subEff}[2]{#1 \rightarrowtail #2}
\newcommand{\subRet}[2]{#1 \rightharpoondown #2}


\makeatletter
\def\rightarrowtailfill@{\arrowfill@{\Yright\joinrel\relbar}\relbar\rightarrow}
\newcommand\xrightarrowtail[2][]{\ext@arrow 0055{\rightarrowtailfill@}{#1}{#2}}
\makeatother

\newcommand{\subReifier}[3][]{#2 \xrightarrowtail[#1]{} #3}


%%%%% example programs and stuff
\newcommand{\factbody}{\mathsf{factBody}}
\newcommand{\fact}{\mathsf{fact}}
\newcommand{\acc}{{\mathit acc}}

\newcommand{\sem}[1]{\llbracket{#1}\rrbracket}

% Categories
% category
\newcommand{\cat}[1]{\mathscr{#1}}      % Arbitrary category
\newcommand{\scat}[1]{\mathbf{#1}}      % Arbitrary small category
\newcommand{\fcat}[1]{\mathbf{#1}}      % Typeface for fixed categories

\newcommand{\ovln}[1]{\overline{#1}}
\newcommand{\lwr}[1]{\mathbf{#1}}       % \lwr{n} denotes n-element set
\newcommand{\rreg}[1]{\underline{#1}}   % Regular representation
\newcommand{\ynt}[1]{\tilde{#1}}        % Nat transf in Yoneda lemma
\newcommand{\yel}[1]{\hat{#1}}          % Element in Yoneda lemma
\newcommand{\wideyel}[1]{\widehat{#1}}  % Wide version of \yel

\newcommand{\epsln}{\varepsilon}        % \epsilon is not used anywhere

\newcommand{\integers}{\mathbb{Z}}
\newcommand{\rationals}{\mathbb{Q}}
\newcommand{\reals}{\mathbb{R}}
\newcommand{\complexes}{\mathbb{C}}

\DeclareMathOperator{\cset}{\cat{C}}    % Set of closed subsets
\DeclareMathOperator{\Cl}{Cl}           % Closure
\DeclareMathOperator{\Cone}{Cone}       % Cones (in limit sense)
\DeclareMathOperator{\End}{\fcat{End}}  % Endomorphisms
\DeclareMathOperator{\EqCat}{Eq}        % Equalizer
\DeclareMathOperator{\ev}{ev}           % Evaluation
\DeclareMathOperator{\HomCat}{Hom}      % Hom-set/functor
\DeclareMathOperator{\HOM}{\fcat{Hom}}  % Homs between vector spaces
\DeclareMathOperator{\im}{im}           % Image
\DeclareMathOperator{\Lan}{Lan}         % Left Kan extension
\DeclareMathOperator{\ob}{ob}           % Object-set
\DeclareMathOperator{\oset}{\cat{O}}    % Set of open subsets
\DeclareMathOperator{\pr}{pr}           % Projection
\DeclareMathOperator{\psetCat}{\cat{P}} % Power set
\DeclareMathOperator{\Sub}{Sub}         % Set of subobjects

\newcommand{\h}{H}                      % Homs (e.g. \h_A means Hom(-, A))
\newcommand{\opCat}{\mathrm{op}}        % Opposite category
\newcommand{\true}{\texttt{true}}       % Truth value "true"
\newcommand{\false}{\texttt{false}}     % Truth value "false"

\newcommand{\One}{\mathbf{1}}           % Terminal category
\newcommand{\Two}{\mathbf{2}}           % Single-arrow category
\newcommand{\Ab}{\fcat{Ab}}             % Abelian groups
\newcommand{\Bilin}{\fcat{Bilin}}       % Bilinear maps
\newcommand{\Cat}{\fcat{Cat}}           % Small categories
\newcommand{\CAT}{\fcat{CAT}}           % All categories
\newcommand{\CptHff}{\fcat{CptHff}}     % Compact Hausdorff spaces
\newcommand{\CRing}{\fcat{CRing}}       % Commutative rings
\newcommand{\FDVect}{\fcat{FDVect}}     % Fin-dim vector spaces
\newcommand{\Field}{\fcat{Field}}       % Fields
\newcommand{\FinSet}{\fcat{FinSet}}     % Finite sets
\newcommand{\Fix}{\fcat{Fix}}           % Fixed-point category
\newcommand{\Grp}{\fcat{Grp}}           % Groups
\newcommand{\Mt}{\fcat{Mat}}            % Matrices
\newcommand{\Mon}{\fcat{Mon}}           % Monoids
\newcommand{\Ord}{\fcat{Ord}}           % Total orders
\newcommand{\Ring}{\fcat{Ring}}         % Rings
\newcommand{\Set}{\fcat{Set}}           % Sets
\newcommand{\Sym}{\fcat{Sym}}           % Permutations
\newcommand{\Tp}{\fcat{Top}}            % Topological spaces
\newcommand{\Toph}{\fcat{Toph}}         % Topo spaces + hty classes of maps
\newcommand{\Vect}{\fcat{Vect}}         % Vector spaces


% CONSTANT SYMBOLS


\newcommand{\such}{\mathrel{|}}         % Separator in set-builder notation
\newcommand{\Bigsuch}{\mathrel{\big|}}  % Big version of \such
\newcommand{\without}{\setminus}        % Set complement

\newcommand{\emptybk}{\hspace*{.5em}}   % Empty space used as blank
\newcommand{\blank}{(\emptybk)}         % Generic blank
\newcommand{\dashbk}{-}                 % Dash used as blank
\newcommand{\bl}{\bullet}               % Bullet used as blank

\newcommand{\from}{{\colon}\linebreak[0]}       % Colon for f: A --> B

\newcommand{\iso}{\cong}                % Isomorphism
\newcommand{\eqv}{\simeq}               % Equivalence
\newcommand{\sub}{\subseteq}            % Subset (possibly not proper)
\newcommand{\ladj}{\dashv}              % Left adjoint
\newcommand{\divides}{\mathbin{\mid}}   % For divisibility of integers
\newcommand{\of}{\mathbin{\circ}}       % Composition

\newcommand{\meet}{\wedge}              % Joins and meets in ordered sets
\newcommand{\Meet}{\bigwedge}
\newcommand{\join}{\vee}
\renewcommand{\Join}{\bigvee}

% MATHEMATICAL EXPRESSIONS TAKING ARGUMENTS


\newcommand{\ftrcat}[2]{[#1,#2]}                % Functor category
\newcommand{\pshf}[1]{\ftrcat{#1^\op}{\Set}}    % Presheaf category
\newcommand{\psh}[1]{\hat{#1}}                  % Alternative pshf cat

\newcommand{\elt}[1]{\scat{E}(#1)}              % Category of elements

\newcommand{\colt}[1]{\lim\limits_{\rightarrow #1}}     % Colimit
\newcommand{\lt}[1]{\lim\limits_{\leftarrow #1}}        % Limit

\newcommand{\abel}[1]{#1_{\mathrm{ab}}}                 % Abelianization
\newcommand{\comma}[2]{(#1 \mathbin{\Rightarrow} #2)}   % Comma cat
\newcommand{\qer}[2]{#1/\mathord{#2}}   % Eq reln for use after slash
\newcommand{\crd}[1]{\left|#1\right|}   % Cardinality


% ARROWS


\newcommand{\oppairu}{\rightleftarrows}         % Unlabelled opposing pair
\newcommand{\oppairua}{\leftrightarrows}        % Same, but reversed
\newcommand{\parpairu}{\rightrightarrows}       % Unlabelled parallel pair
\newcommand{\ot}{\leftarrow}                    % Left-pointing arrow
\newcommand{\toby}[1]{\stackrel{#1}{\longrightarrow}}   % Labelled arrow
\newcommand{\otby}[1]{\stackrel{#1}{\longleftarrow}}    % Left lblld arrow
\newcommand{\longto}{\longrightarrow}           % Long labelled arrow
\newcommand{\toiso}{\toby{\textstyle{}_\sim}}   % Isomorphism arrow
\newcommand{\incl}{\hookrightarrow}             % Inclusion arrow
\newcommand{\mapsfromCat}{\mathrel{\reflectbox{\ensuremath{\mapsto}}}}
% Left-pointing \mapsto
\newcommand{\textiff}{\Longleftrightarrow}      % Iff arrow for use in text
\newcommand{\textif}{\Longleftarrow}            % If arrow for use in text
\newcommand{\textonlyif}{\Longrightarrow}       % Only if arrow for text


\newcommand{\nent}{\rotatebox{45}{$\Rightarrow$}}
% North-east-pointing arrow for natural transformations
\newcommand{\nwnt}{\rotatebox{-45}{$\Leftarrow$}}       % North-west
\newcommand{\swnt}{\rotatebox{45}{$\Leftarrow$}}        % South-west
\newcommand{\sent}{\rotatebox{-45}{$\Rightarrow$}}      % South-east
\newcommand{\neeq}{\rotatebox{45}{$=$}}

\newcommand{\oppair}[4]{%
  \xymatrix{%
    #1 \ar@<.5ex>[r]^-{#3} &{#2}\ar@<.5ex>[l]^-{#4}%
  }}
% Opposite-pointing pair of arrows, with arguments, for use in displays

\newcommand{\oppairi}[4]{%
  \xymatrix@1{%
    #1 \ar@<.5ex>[r]^{#3} &{#2}\ar@<.5ex>[l]^{#4}%
  }}
% Opposite-pointing pair of arrows, with arguments, for use in text

\newcommand{\parpair}[4]{%
  \xymatrix{%
    #1 \ar@<.5ex>[r]^{#3} \ar@<-.5ex>[r]_{#4} &#2%
  }}
% Parallel pair of arrows, with arguments, for use in displays

\newcommand{\parpairi}[4]{%
  \xymatrix@1{%
    #1 \ar@<.5ex>[r]^{#3} \ar@<-.5ex>[r]_{#4} &#2%
  }}
% Parallel pair of arrows, with arguments, for use in text

\newcommand{\adjn}[4]{%
  \xymatrix{
    #1 \ar@{}[d]|\ladj \ar@<1ex>[d]^{#4} \\
    #2 \ar@<1ex>[u]^{#3}
  }}
% Adjunction, with arguments, for use in displays

\newcommand{\hadjnli}[4]{%
  \xymatrix@1{
    #1 \ar@<1.1ex>[r]^-{#3} \ar@{}[r]|-\bot &#2 \ar@<1.1ex>[l]^-{#4}}}
% Adjunction, with arguments, for use in text (left adjt on top)

\newcommand{\hadjnri}[4]{%
  \xymatrix@1{
    #1 \ar@<1.1ex>[r]^-{#3} \ar@{}[r]|-\top &#2 \ar@<1.1ex>[l]^-{#4}}}
% Adjunction, with arguments, for use in text (left adjt on bottom)

\newcommand{\searrows}{\makebox[1em]{$\downarrow$%
    \hspace*{-.2em}\raisebox{-1ex}{$\rightarrow$}}}
% Little diagram of anticlockwise path around a commutative square

\newcommand{\esarrows}{\makebox[1em]{%
    \raisebox{1ex}{$\rightarrow$}\hspace*{-.2em}$\downarrow$}}
% Little diagram of clockwise path around a commutative square